# Great Expectations
Great Expectations is an open-source data validation framework that helps to build a data validation layer in the data pipeline with built-in and 
custom data validation methods. It also provides features to build actionable data quality checks by triggering alerts or sending email notifications.

## Basic Setup
The following is the basic instructions to spin up Great Expecations for a project. <br>
More detailed instructions for custom configuration can be found from: https://docs.greatexpectations.io/docs/

### Setup
Install great_expectations

    pip install great_expectations
    
Create a data context in the project directory using Great Expectations CLI command. 
Data context is the primary entry point for a Great Expectations deployment, with 
configurations and methods for all supporting components.

    great_expectations init

It will create the following structure:

    great_expectations
    |-- great_expectations.yml: contains the main configuration of your deployment
    |-- expectations: stores all your Expectations (validation rules) as JSON files.
    |-- checkpoints
    |-- plugins: holds code for any custom plugins
    |-- .gitignore
    |-- uncommitted: contains files that shouldnâ€™t live in version control
        |-- config_variables.yml: holds sensitive information, such as database credentials and other secrets
        |-- data_docs: contains Data Docs generated from Expectations, Validation Results, and other metadata
        |-- validations: holds Validation Results generated by Great Expectations
    
### Connect to Data
Connection to the data needs to be configured before running Great Expectations for validation. And datasource refers
to a data connection in Great Expectations. <br>
Great Expectations CLI commands can be used.

    great_expectations datasource new
    
Questions will be asked to choose the data location, processing engine and datasource name. <br>

    What data would you like Great Expectations to connect to?
    1. Files on a filesystem (for processing with Pandas or Spark)
    2. Relational database (SQL)
    
    What are you processing your files with?
    1. Pandas
    2. PySpark

When local file is selected, path needs to be given.

    Enter the path of the root directory where the data files are stored. If files are on local disk 
    enter a path relative to your current working directory or an absolute path.
    :

Then Jupyter notebook will be prompted to continue data connection configuration. When database is selected for the 
data location, connection information needs to be given.


### Create Expectations
Expectations are the validation rules in Great Expectations. And an expectation suite is a collection of expectations.<br>
Expectation suite can be created using the following CLI command.

    great_expectations suite new
    
A question will be prompted to ask how to create the expectation suite.

    How would you like to create your Expectation Suite?
    1. Manually, without interacting with a sample batch of data (default)
    2. Interactively, with a sample batch of data
    3. Automatically, using a profiler
    
Afterwards, a Jupyter Notebook will be prompted to continue configuration. 
When 2 or 3 is selected, a sample dataset is required to create expectations.

### Validate Data
Lastly, a checkpoint is to be created. Checkpoint validates a dataset against the expectation suite. <br>
Hence, it requires both datasource and expectation suite for configuration. <br>
It can be created as below:

    great_expectations checkpoint new <checkpoint_name>
    
It will open a Jupyter Notebook and the datasource and expectation suite can be given to the configuration. <br>
The last code cell of the notebook will run the checkpoint and open up the Data Doc in browser to show validation results.

## CLI Commands
The following commands can be used to easily configure and run Great Expectations.

- great_expectations init: Initialise Great Expectations in the project directory
- great_expectations datasource new: Creates a new datasource for data connection
- great_expectations suite new: Create a new expectation suite for validation rules
- great_expectations checkpoint new <checkpoint_name>: Creates a new checkpoint for validation check using datasource and expectation suite
- great_expectations checkpoint run <checkpoint_name>: Runs a checkpoint to validate the dataset against expectation suite as configured
